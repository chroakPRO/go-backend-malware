package models

import (
	"time"

	"github.com/google/uuid"
)

type AccessToken struct {
	ID            uuid.UUID 	`db:"id" json:"id" validate:"required,uuid"`
	CreatedAt     time.Time 	`db:"created_at" json:"created_at"`
	UpdatedAt     time.Time 	`db:"updated_at" json:"updated_at"`
	UserID        uuid.UUID 	`db:"user_id" json:"user_id" validate:"required,uuid"`
	Scope         string       	`db:"scope" json:"scope" validate:"required,lte=255"`
	RequestAccess RequestAccess `db:"request_access" json:"request_access" validate:"required,dive"`
}

type RequestAccess struct {
	ID        uuid.UUID `db:"id" json:"id" validate:"required,uuid"`
	// Should contain the groups that the request is required for access to.
	Required  []string  `db:"required" json:"required" validate:"required,lte=255"`
}