package models

import (
	"time"

	"github.com/google/uuid"
)

type Permission struct {
	ID           uuid.UUID   `db:"id" json:"id" validate:"required,uuid"`
	ReqCreatedAt time.Time   `db:"created_at" json:"created_at"`
	UserID       uuid.UUID   `db:"user_id" json:"user_id" validate:"required,uuid"`
	Access		 AccessToken `db:"access" json:"access" validate:"required,dive"`
	RequestPerm  RequestPerm `db:"request_perm" json:"request_perm" validate:"required,dive"`

}

type RequestPerm struct {
	ID        uuid.UUID `db:"id" json:"id" validate:"required,uuid"`
	// Should contain the groups that the request is required for access to.
	// Least privilage principle is used.
	Required  []string  `db:"required" json:"required" validate:"required,lte=255"`
}